/**
 * Generated by scaffdog
 * feature name is article
 * created at 2024/10/29
 **/
import "@typespec/openapi";
import "@typespec/rest";
import "./model.tsp";
import "../rest-util/error-response.tsp";

using TypeSpec.Http;
using TypeSpec.OpenAPI;
using TypeSpec.Rest;

namespace ArticleAPI {
  model ArticleListResponse {
    items: Article[];
  }

  model ArticleResponse {
    article: Article;
  }

  model ArticleDeleteResponse {
    id: ArticleId;
  }

  model ArticleDetailParameter {
    @path
    @segment("articles")
    id: integer;
  }
}

@tag("article")
@route("/articles")
interface Articles {
  @operationId("listArticles")
  @get
  listArticles(): ArticleAPI.ArticleListResponse;

  @operationId("createArticle")
  @post
  createArticle(
    dto: ArticleOperation.CreateArticleDTO,
  ): ArticleAPI.ArticleResponse | ErrorResponse<
    400,
    ArticleOperation.ParameterInavlid
  >;
}

@tag("article")
@autoRoute
interface ArticleItem {
  @operationId("readArticle")
  @get
  resourceReadArticle(
    ...ArticleAPI.ArticleDetailParameter,
  ): ArticleAPI.ArticleResponse | ErrorResponse<
    404,
    ArticleOperation.NotFoundArticle
  >;

  @operationId("updateArticle")
  @put
  editArticle(
    ...ArticleAPI.ArticleDetailParameter,
    dto: ArticleOperation.UpdateArticleDTO,
  ): ArticleAPI.ArticleResponse | ErrorResponse<
    404,
    ArticleOperation.NotFoundArticle
  > | ErrorResponse<400, ArticleOperation.ParameterInavlid>;

  @operationId("deleteArticle")
  @delete
  deleteArticle(
    ...ArticleAPI.ArticleDetailParameter,
  ): ArticleAPI.ArticleDeleteResponse | ErrorResponse<
    404,
    ArticleOperation.NotFoundArticle
  >;
}

namespace ArticleCommentAPI {
  model ArticleCommentListResponse {
    items: Comment[];
  }

  model ArticleCommentResponses {
    comment: Comment;
  }
}

@tag("comment")
@tag("article")
@route("/articles/{id}/comments")
interface ArticleComments {
  @operationId("getArticleComments")
  @get
  getArticleComments(
    ...ArticleAPI.ArticleDetailParameter,
  ): ArticleCommentAPI.ArticleCommentListResponse | ErrorResponse<
    404,
    ArticleOperation.NotFoundArticle
  >;

  @operationId("createArticleComment")
  @post
  createArticleComment(
    ...ArticleAPI.ArticleDetailParameter,
    dto: ArticleCommentOperation.CreateCommentDTO,
  ): ArticleCommentAPI.ArticleCommentResponses | ErrorResponse<
    404,
    ArticleOperation.NotFoundArticle
  > | ErrorResponse<400, ArticleOperation.ParameterInavlid>;
}
